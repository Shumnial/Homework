"use strict";$(function(){function t(){u.mask("+7(999) 999-9999")}function n(){var t=$(this).closest(".c-contact"),n=+$(t).attr("data-id"),a=m.findIndex(function(t){return t.id===n});m.splice(a,1),e(),t.addClass("c-contact--slide-right"),setTimeout(function(){t.remove()},250)}function a(t){function n(){var n=void 0,a=d,c=m.map(function(a){var c=t===a.id?"c-contact--slide-default":"";return a.coords&&(n=new ymaps.Placemark(a.coords,{hintContent:a.name+" "+a.lastname,balloonContent:""}),f.geoObjects.add(n)),'<li class="c-contact '+c+'" data-id="'+a.id+'"><div class="c-contact__lastname">Фамилия: '+a.lastname+'</div>\n\t\t\t<div class="c-contact__name">Имя: '+a.name+'</div>\n\t\t\t<div class="c-contacts__address">Улица: '+a.address+'</div>\n\t\t\t<div class="c-contact__tel">Тел: '+a.tel+'</div>\n\t\t\t<button class="c-contact__delete-btn">DELETE</button></li>'});a.html(c)}ymaps.ready(n)}function c(){var t=localStorage.getItem("users");t&&(m=JSON.parse(t))}function e(){localStorage.setItem("users",JSON.stringify(m))}function o(){m.sort(function(t,n){return t.lastname<n.lastname?-1:t.lastname>n.lastname?1:0})}function s(){f=new ymaps.Map("map",{center:[56.84,60.6],zoom:11})}function r(t){var n=ymaps.geocode(t);return n.then(function(t){var n=t.geoObjects.get(0),a=n?n.geometry.getCoordinates():null;if(a){f.setCenter(a,18);var c=new ymaps.Placemark(a,{hintContent:"Моя метка!",balloonContent:"Ура"});f.geoObjects.add(c)}return console.log("coords: ",a),a})["catch"](function(t){return console.log("err: ",t)})}function i(t){t.preventDefault();var n=$(".c-contacts-form__tel").val(),c=m.find(function(t){return t.tel===n});if(c)return void u.addClass("c-contacts-form__tel--invalid");u.removeClass("c-contacts-form__tel--invalid");var s=$(this).serializeArray(),i={};s.forEach(function(t){i[t.name]=t.value}),i.id=Date.now(),r(i.address).then(function(t){return t?(i.coords=t,m.push(i),o(),e(),void a(i.id)):void alert("Неверный адрес")})}var l=$(".c-contacts-form"),d=$(".c-contacts-list"),u=($(".c-contacts-form__name"),$(".c-contacts-form__lastname"),$(".c-contacts-form__tel"));t();var m=[];c(),ymaps.ready(s);var f;a(),l.on("submit",i),$(document).on("click",".c-contact__delete-btn",n)});
//# sourceMappingURL=../javascripts/common.js.map
