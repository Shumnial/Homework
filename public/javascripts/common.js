"use strict";$(function(){function t(){var t=$(this).closest(".c-contact"),n=+$(t).attr("data-id"),e=u.findIndex(function(t){return t.id===n});u.splice(e,1),a(),t.addClass("c-contact--slide-right"),setTimeout(function(){t.remove()},250)}function n(t){function n(){var n=void 0,e=l,a=u.map(function(e){var a=t===e.id?"c-contact--slide-default":"";return e.coords&&(m.setCenter(e.coords,18),n=new ymaps.Placemark(e.coords,{hintContent:e.name+" "+e.lastname,balloonContent:"<p>"+e.name+" "+e.lastname+'</p><button class="remove-placemark">DELETE</button>'}),m.geoObjects.add(n),m.geoObjects.events.add("click",function(t){var n=t.get("target");m.geoObjects.remove(n)})),'<li class="c-contact '+a+'" data-id="'+e.id+'"><div class="c-contact__lastname">Фамилия: '+e.lastname+'</div>\n\t\t\t<div class="c-contact__name">Имя: '+e.name+'</div>\n\t\t\t<div class="c-contacts__address">'+e.address+'</div>\n\t\t\t<div class="c-contact__tel">Тел: '+e.tel+'</div>\n\t\t\t<button class="c-contact__delete-btn">DELETE</button></li>'});e.html(a)}ymaps.ready(n)}function e(){var t=localStorage.getItem("users");t&&(u=JSON.parse(t))}function a(){localStorage.setItem("users",JSON.stringify(u))}function c(){u.sort(function(t,n){return t.lastname<n.lastname?-1:t.lastname>n.lastname?1:0})}function o(){m=new ymaps.Map("map",{center:[56.84,60.6],zoom:11})}function s(t){var n=ymaps.geocode(t);return n.then(function(t){var n=t.geoObjects.get(0),e=n?n.geometry.getCoordinates():null;return e})["catch"](function(t){return console.log("err: ",t)})}function r(t){t.preventDefault();var e=$(".c-contacts-form__tel").val(),o=u.find(function(t){return t.tel===e});if(o)return void d.addClass("c-contacts-form__tel--invalid");d.removeClass("c-contacts-form__tel--invalid");var r=$(this).serializeArray(),i={};r.forEach(function(t){i[t.name]=t.value}),i.id=Date.now(),s(i.address).then(function(t){return t?(i.coords=t,u.push(i),c(),a(),void n(i.id)):void alert("Неверный адрес")})}var i=$(".c-contacts-form"),l=$(".c-contacts-list"),d=($(".c-contacts-form__name"),$(".c-contacts-form__lastname"),$(".c-contacts-form__tel")),u=[];e(),ymaps.ready(o);var m;n(),i.on("submit",r),$(document).on("click",".c-contact__delete-btn",t)});
//# sourceMappingURL=../javascripts/common.js.map
